!function(){"use strict";"undefined"==typeof define&&"undefined"==typeof exports&&(window.ppr={page:{},component:{},library:{utils:{}},module:{},ui:{}})}(),function(t,e){"function"==typeof define&&define.amd?define("ppr.config",["lodash"],e):"object"==typeof exports?module.exports=e(require("lodash")):t.ppr.config=e(t._)}(this,function(){"use strict";var t={};return{get:function(e,n){return _.result(t,e,n)},getAll:function(){return t},set:function(e,n){var i=e;"string"==typeof e&&(i={},i[e]=n),_.each(i,function(e,n){_.set(t,n,e)})},reset:function(){t={}}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.event_bus_prototype",["jquery","lodash"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("lodash")):t.ppr.library.event_bus_prototype=e(t.$,t._)}(this,function(t,e){"use strict";var n=function(e){this.eventList={},this.messageIndex={},this.configList=t.extend({},{debug:!1},e)};return n.prototype={getEvents:function(){return this.eventList},getEventsByMessage:function(t){return"undefined"!=typeof this.eventList[t]?this.eventList[t]:{}},log:function(t,e,n){if(this.configList.debug!==!0)return!1;Array.prototype.slice.call(arguments).splice(2,2);switch(t){case"subscribe":break;case"unsubscribe":break;case"publish":}},subscribe:function(t,n,i){"undefined"==typeof this.eventList[n]&&(this.eventList[n]={});var r=e.uniqueId(n);return this.log("subscribe",n,r,t),this.eventList[n][r]={scope:t,callback:i},this.messageIndex[r]=n,r},unsubscribe:function(t){"string"==typeof t&&(t=[t]);var n=this;return e.each(t,function(i){if("undefined"==typeof n.messageIndex[i])return!1;var r=n.messageIndex[i];return n.log("unsubscribe",r,t),"undefined"!=typeof n.eventList[r][i]&&(delete n.eventList[r][i],void(0===e.keys(n.eventList[r]).length&&delete n.eventList[r]))}),!0},publish:function(t,n){var i=Array.prototype.slice.call(arguments);return i.shift(),this.log("publish",t,i,e.map(this.eventList[t],"scope")),"undefined"!=typeof this.eventList[t]&&void e.each(this.eventList[t],function(t){t.callback.apply(t.scope,i)})}},n}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.date",["ppr.translation"],e):"object"==typeof exports?module.exports=e(require("../../ppr.translation")):t.ppr.library.utils.date=e(t.ppr.translation)}(this,function(t){"use strict";return{getAsDate:function(t){if("object"==typeof t)return t;if("number"==typeof t)return new Date(t);var e;return(e=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/,"g"))?new Date(e[1],e[2]-1,e[3],e[4],e[5],e[6]):(e=t.match(/^([0-9]{2}).([0-9]{1,2}).([0-9]{4}) ([0-9]{1,2}):([0-9]{2}):([0-9]{2})$/,"g"))?new Date(e[3],e[2]-1,e[1],e[4],e[5],e[6]):new Date(t)},getDifference:function(t,e){return"undefined"==typeof e&&(e=new Date),t=this.getAsDate(t),e=this.getAsDate(e),(e.getTime()-t.getTime())/1e3},getAsDifferenceString:function(e){return e<60?Math.floor(e)+t.translate("date.sec_ago"):e<3600?Math.floor(e/60)+t.translate("date.min_ago"):e<86400?Math.floor(e/60/60)+t.translate("date.hour_ago"):Math.floor(e/60/60/24)+t.translate("date.day_ago")},formatDate:function(t){var e=t.getFullYear().toString(),n=(t.getMonth()+1).toString(),i=t.getDate().toString(),r=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();return i+"."+n+"."+e+" klo "+r+":"+o}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.loader",["lodash"],e):"object"==typeof exports?module.exports=e(require("lodash")):t.ppr.library.utils.loader=e(t._)}(this,function(t){"use strict";return{hasAMDSupport:function(){return"function"==typeof define&&define.amd},hasCommonSupport:function(){return"object"==typeof exports},load:function(e,n,i){if("function"!=typeof i)throw new Error("Callback has to present");"object"!=typeof e&&(e=[e]);var r=[];return this.hasAMDSupport()?(n.custom===!0&&(e=t.map(e,function(t){if(t.lastIndexOf(".")>t.lastIndexOf("/")){t=t.split(".");var e=t.pop();t=t.join(".")+"/"+e}return t})),require(e,i)):this.hasCommonSupport()?(t.each(e,function(e){e=e.split("."),e.shift(),e=t.map(e,t.camelCase),e.unshift("../.."),e=e.join("/").toLowerCase().trim(),r.push(require(e))}),i.apply(null,r)):(t.each(e,function(e){r.push(t.get(window,e))}),i.apply(null,r))}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.object",[],e):"object"==typeof exports?module.exports=e():t.ppr.library.utils.object=e()}(this,function(){"use strict";return{stringify:function(t){var e;if("string"==typeof t)return t;try{e=JSON.stringify(t)}catch(n){e=""}return e},parseJSON:function(t){var e;if("object"==typeof t)return t;try{e=JSON.parse(t)}catch(n){e={}}return e}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.request",["lodash"],e):"object"==typeof exports?module.exports=e(require("lodash")):t.ppr.library.utils.request=e(t._)}(this,function(){"use strict";return{query:{},getQueryParam:function(t,e,n){var i=this.getQueryParams(n);return i.hasOwnProperty(t)?i[t]:"undefined"!=typeof e?e:null},getQueryParams:function(t){"undefined"==typeof t&&(t=window.location.href);var e,n,i={},r=t.indexOf("?");return this.query.hasOwnProperty(t)?this.query[t]:r===-1?i:(e=t.substring(r+1),n=e.split("&"),_.each(n,function(t){var e=t.split("=");i[e[0]]=e[1]}),this.query[t]=i,i)}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.storage",[],e):"object"==typeof exports?module.exports=e():t.ppr.library.utils.storage=e()}(this,function(){"use strict";return{isSupported:function(){return"undefined"!=typeof window.localStorage},set:function(t,e){if(!this.isSupported())return null;if("object"==typeof e)try{e=JSON.stringify(e)}catch(n){}window.localStorage.setItem(t,e)},get:function(t){if(!this.isSupported())return null;var e=window.localStorage.getItem(t);try{e=JSON.parse(e)}catch(n){}return e}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.string",["lodash"],e):"object"==typeof exports?module.exports=e(require("lodash")):t.ppr.library.utils.string=e(t._)}(this,function(t){"use strict";return{generateHash:function(t){var e,n,i,r=0;if(0===t.length)return r;for(e=0,i=t.length;e<i;e++)n=t.charCodeAt(e),r=(r<<5)-r+n,r|=0;return r},getAsPlainText:function(t){return $("<p>").html(t).text()},linkifyHashTags:function(t,e){var n,i;return i={twitter:"https://twitter.com/hashtag/",facebook:"https://www.facebook.com/hashtag/",instagram:"https://www.instagram.com/explore/tags/"},e=e.toLowerCase(),"undefined"==typeof i[e]?t:(n=i[e],t=t.replace(/[#]+[A-Za-z0-9-_äöåÄÖÅ]+/g,function(t){var e,i;return e=t.replace("#",""),i=$("<a>").attr("class","hashtag").attr("href",n+e).attr("target","_blank").text(t),i[0].outerHTML}))},replaceVariablesWithParameters:function(e,n){return t.each(n,function(t,n){e=e.replace(":"+n,t)}),e}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.window",["ppr.config","lodash"],e):"object"==typeof exports?module.exports=e(require("../../ppr.config"),require("lodash")):t.ppr.library.utils.window=e(t.ppr.config,t._)}(this,function(t,e){"use strict";return{breakpoints:null,isBreakpoint:function(e){return this.breakpoints||(this.breakpoints=t.get("window.breakpoints",{})),"undefined"!=typeof this.breakpoints[e]},isMobile:function(){var n=this,i=!1;return e.each(t.get("window.mobile_breakpoints",[]),function(t){i||(i=n.matchBreakpoint(t))}),i},matchBreakpoint:function(t){if(!this.isBreakpoint(t))return!1;if("function"!=typeof window.matchMedia)return!1;var n=this.breakpoints[t],i=e.replace(n,/[<>]/,"").trim();return e.startsWith(n,"<")?window.matchMedia("(max-width: "+i+"px)").matches:!!e.startsWith(n,">")&&window.matchMedia("(min-width: "+i+"px)").matches},transformations:function(t){return{"-webkit-transform":t,"-moz-transform":t,"-ms-transform":t,"-o-transform":t,transform:t}},whichTransitionEvent:function(){var t,e=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in n)if(void 0!==e.style[t])return n[t]}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.translation",["ppr.config","ppr.library.utils.string","lodash"],e):"object"==typeof exports?module.exports=e(require("./ppr.config"),require("./library/utils/string"),require("lodash")):t.ppr.translation=e(t.ppr.config,t.ppr.library.utils.string,t._)}(this,function(t,e,n){"use strict";var i;return i={isInitialized:!1,language:void 0,translationList:void 0,initialize:function(){this.language=t.get("language","en"),this.translationList=t.get("translations",{})},getAll:function(){return this.isInitialized||this.initialize(),this.translationList},getLanguage:function(t){return"undefined"!=typeof t?t:this.language},getPrefixedKey:function(t,e){return t+"."+e},translate:function(t,i,r){this.isInitialized||this.initialize();var o=n.result(this.translationList,this.getPrefixedKey(this.getLanguage(r),t),t);return"undefined"!=typeof i&&(o=e.replaceVariablesWithParameters(o,i)),o},translateFromSource:function(t,e,n){var i=this.getLanguage(n),r=this.getPrefixedKey(t,i);return e.hasOwnProperty(r)?e[r]:null}},{getAll:function(){return i.getAll()},translate:function(t,e,n){return i.translate(t,e,n)},translateFromSource:function(t,e,n){return i.translateFromSource(t,e,n)}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.component.base_prototype",["ppr.library.utils.object"],e):"object"==typeof exports?module.exports=e(require("../library/utils/object")):t.ppr.component.base_prototype=e(t.ppr.library.utils.object)}(this,function(t){"use strict";return{children:void 0,eventBus:null,data:{},href:null,id:null,name:null,node:null,page:null,parent:void 0,messages:{},isBuilt:!1,cacheData:{},cacheSubscribers:[],afterBuild:function(){this.eventBus.publish("component_build_finished",this.id),this.isBuilt=!0},build:function(){},getChildren:function(){var t=this;if("undefined"==typeof this.children){var e=[];_.each(this.node.find("[data-component]"),function(n){var i=$(n).attr("data-component-id"),r=t.page.getComponent(i);r.getParent().id===t.id&&e.push(i)}),this.children=e}var n=[];return _.each(this.children,function(e){n.push(t.page.getComponent(e))}),n},getParent:function(){if("undefined"!=typeof this.parent)return this.page.getComponent(this.parent);var t=this.node.parents("[data-component]:first"),e=null;return t.length&&(e=t.attr("data-component-id")),this.parent=e,this.page.getComponent(this.parent)},getRequiredModules:function(){return[]},initialize:function(e){this.id=e.id,this.node=e.node,this.name=e.name,this.eventBus=e.eventBus,this.page=e.page,this.cacheData=this.data,this.node.attr({"data-component":this.name,"data-component-id":this.id}),this.node.attr("data-component-href")&&(this.href=this.node.attr("data-component-href")),this.node.attr("data-component-data")&&(this.data=$.extend({},this.data,t.parseJSON(this.node.attr("data-component-data"))))},isBuildable:function(){return $.Deferred().resolve().promise()},reset:function(){this.data=$.extend(!0,{},this.cacheData),this.href=null,this.isBuilt=!1,this.eventBus.unsubscribe(this.cacheSubscribers)},setModuleMessages:function(t){this.messages=t},subscribe:function(){var t=Array.prototype.slice.call(arguments);t[1]=this.id+"_"+t[1];var e=this.eventBus.subscribe.apply(this.eventBus,t);return this.cacheSubscribers.push(e),e},publish:function(){var t=Array.prototype.slice.call(arguments);return t[0]=this.id+"_"+t[0],this.eventBus.publish.apply(this.eventBus,t)}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.component.reloadable_prototype",["ppr.component.base_prototype","jquery"],e):"object"==typeof exports?module.exports=e(require("./baseprototype"),require("jquery")):t.ppr.component.reloadable_prototype=e(t.ppr.component.base_prototype,t.$)}(this,function(t,e){"use strict";return e.extend(!0,{},t,{global_reload:!0,componentLoaderWrapper:null,afterBuild:function(){this.componentLoaderWrapper=this.node.find(".component-loader__wrapper"),this.subscribe(this,"reload",this.reload),this.subscribe(this,"reload_started",this.onReloadStarted),this.subscribe(this,"reload_ready",this.onReloadReady),this.global_reload&&this.eventBus.subscribe(this,"reload_components",this.reload),this.eventBus.publish("component_build_finished",this.id),this.isBuilt=!0},onReloadStarted:function(){this.componentLoaderWrapper.length&&this.componentLoaderWrapper.addClass("component-loader__wrapper--active")},onReloadReady:function(t){t=t.filter("*:not(text):not(comment)"),this.reset(),this.node.replaceWith(t),t.attr("data-component-id",this.id),this.eventBus.publish("build_component",t)},reload:function(){var t=this;this.publish("reload_started"),e.get(this.href).done(function(n){t.publish("reload_ready",e(n))})}})}),function(t,e){"function"==typeof define&&define.amd?define("ppr.module.base_prototype",[],e):"object"==typeof exports?module.exports=e():t.ppr.module.base_prototype=e()}(this,function(){"use strict";return{isInitialized:!1,configList:{},eventBus:void 0,messages:{},build:function(){},initialize:function(t,e){return!this.isInitialized&&(this.eventBus=e,this.configList=$.extend({},this.configList,t),this.isInitialized=!0,void this.build())},getMessages:function(){return this.messages}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.page.base_prototype",["ppr.config","ppr.library.utils.object","ppr.library.utils.loader","ppr.library.event_bus_prototype","jquery","lodash"],e):"object"==typeof exports?module.exports=e(require("../ppr.config"),require("../library/utils/object"),require("../library/utils/loader"),require("../library/eventbusprototype"),require("jquery"),require("lodash")):t.ppr.page.base_prototype=e(t.ppr.config,t.ppr.library.utils.object,t.ppr.library.utils.loader,t.ppr.library.event_bus_prototype,t.$,t._)}(this,function(t,e,n,i,r,o){"use strict";return{eventBus:new i(t.get("event_bus",{})),name:null,node:null,components:{},data:null,cacheComponentReady:[],afterBuild:function(){this.setDefaultSubscribers(),this.buildComponents(),this.buildUIExtensions()},build:function(){return!0},buildComponent:function(t){var e,i=this,s=t.attr("data-component").trim(),a=o.snakeCase(s),u={},p={};s.length>0?(e="ppr.component."+a,p.custom=!0):t.attr("data-component-href")?(e="ppr.component.reloadable_prototype",s="reloadable_prototype"):(e="ppr.component.base_prototype",s="base_prototype"),t.attr("data-component-id")?u.id=t.attr("data-component-id"):u.id=o.uniqueId("Component_"),u.name=s,u.node=t,u.eventBus=this.eventBus,u.page=this,n.load(e,p,function(e){var s=new function(){return r.extend(!0,{},e)};i.components[u.id]=s,s.initialize(u);var a=s.getRequiredModules(),p=o.map(a,function(t){return"ppr.module."+t});n.load(p,{custom:!0},function(){var e=Array.prototype.slice.call(arguments),n={};o.each(e,function(t,e){t.initialize({},i.eventBus),n[a[e]]=t.getMessages()}),s.setModuleMessages(n),s.isBuildable().then(function(e){return s.build(e)===!1?(delete i.components[u.id],void t.remove()):void s.afterBuild()})})})},buildComponents:function(){var t=this;this.node.find("[data-component]").each(function(e,n){t.eventBus.publish("build_component",r(n))})},buildUIExtensions:function(){n.load(t.get("ui.builders",[]),{custom:!0},function(){var t=Array.prototype.slice.call(arguments);o.each(t,function(t){t.initialize()})})},getComponent:function(t){return"undefined"!=typeof this.components[t]?this.components[t]:null},initialize:function(t){this.name=t.name,this.node=t.node,this.data={},this.node.attr("data-page-data")&&(this.data=r.extend({},this.data,e.parseJSON(this.node.attr("data-page-data"))))},onComponentBuildFinished:function(t){this.cacheComponentReady.push(t),this.cacheComponentReady.length===o.keys(this.components).length&&this.eventBus.publish("page_build_finished")},setDefaultSubscribers:function(){this.eventBus.subscribe(this,"build_component",this.buildComponent),this.eventBus.subscribe(this,"component_build_finished",this.onComponentBuildFinished)}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr.ui.builder_prototype",["ppr.library.utils.loader","lodash"],e):"object"==typeof exports?module.exports=e(require("../library/utils/loader"),require("lodash")):t.ppr.ui.builder_prototype=e(t.ppr.library.utils.loader,t._)}(this,function(t,e){"use strict";return{initialize:function(){var e=this;return!!this.shouldBuild()&&void t.load(this.getDependencies(),{custom:!0},function(){e.build.apply(e,Array.prototype.slice.call(arguments))})},shouldBuild:function(){return!0},getDependencies:function(){return[]}}}),function(t,e){"function"==typeof define&&define.amd?define("ppr",["jquery","lodash","ppr.library.utils.loader","ppr.config"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("lodash"),require("./library/utils/loader"),require("./ppr.config")):t.ppr=t._.assign(t.ppr,e(t.jQuery,t._,t.ppr.library.utils.loader,t.ppr.config))}(this,function(t,e,n,i){"use strict";return{build:function(){this.buildPage()},buildPage:function(){var i=this,r="ppr.page.base_prototype",o=t("body"),s=o.attr("data-page"),a={},u={};"undefined"!=typeof s&&s.length>0?(r="ppr.page."+e.snakeCase(s.trim()),u.custom=!0):s="base_prototype",a.name=s,a.node=o,n.load(r,u,function(e){var n=new function(){return t.extend(!0,{},e)};n.initialize(a),i.page_instance=n,n.build(),n.afterBuild()})},loadConfig:function(e){var n=this,i=t.Deferred();return t.ajax({dataType:"json",url:e,success:function(t){n.setConfig(t),i.resolve(t)},fail:function(){i.reject("Load configuration failed")}}),i.promise()},setConfig:function(t){e.each(t,function(t,e){i.set(e,t)})}}});